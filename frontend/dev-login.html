<!DOCTYPE html>
<html>
<head>
    <title>Dev Login - Quick Test</title>
    <style>
        body { 
            font-family: Arial, sans-serif; 
            max-width: 500px; 
            margin: 50px auto; 
            padding: 20px; 
        }
        button { 
            padding: 10px 15px; 
            margin: 10px 0; 
            cursor: pointer; 
            background: #0070f3; 
            color: white; 
            border: none; 
            border-radius: 5px; 
        }
        button:hover { background: #0051cc; }
        .status { 
            background: #f0f0f0; 
            padding: 15px; 
            border-radius: 5px; 
            margin: 20px 0; 
        }
        .success { background: #d4edda; }
        .error { background: #f8d7da; }
    </style>
</head>
<body>
    <h1>üöÄ Dev One-Click Login Test</h1>
    <p><strong>‚ö†Ô∏è DEV ONLY - Remove before production!</strong><br/>Quick login buttons for all test users with automatic redirect to dashboard.</p>
    
    <h3>üî¥ Super Admin</h3>
    <button onclick="quickLogin('superadmin@system.com', 'SuperAdmin123!')">Super Admin - Global Access</button>
    
    <h3>üîµ PowerFlex Fitness</h3>
    <button onclick="quickLogin('owner@powerflex-fitness.com', 'Owner123!')">Owner - All 3 Branches</button>
    <button onclick="quickLogin('manager1@powerflex-fitness.com', 'Manager123!')">Manager1 - Main + North</button>
    <button onclick="quickLogin('manager2@powerflex-fitness.com', 'Manager123!')">Manager2 - South + North</button>
    <button onclick="quickLogin('staff11@powerflex-fitness.com', 'Staff123!')">Staff1 - Main Only</button>
    <button onclick="quickLogin('staff12@powerflex-fitness.com', 'Staff123!')">Staff2 - South Only</button>
    
    <h3>üü¢ FitLife Gym</h3>
    <button onclick="quickLogin('owner@fitlife-gym.com', 'Owner123!')">Owner - All 3 Branches</button>
    <button onclick="quickLogin('manager11@fitlife-gym.com', 'Manager123!')">Manager1 - Main + East</button>
    <button onclick="quickLogin('manager12@fitlife-gym.com', 'Manager123!')">Manager2 - West + East</button>
    <button onclick="quickLogin('staff11@fitlife-gym.com', 'Staff123!')">Staff1 - Main + East</button>
    <button onclick="quickLogin('staff12@fitlife-gym.com', 'Staff123!')">Staff2 - Main + East</button>
    <button onclick="quickLogin('staff21@fitlife-gym.com', 'Staff123!')">Staff3 - West + East</button>
    <button onclick="quickLogin('staff22@fitlife-gym.com', 'Staff123!')">Staff4 - West Only</button>
    
    <hr>
    <button onclick="testBackendAuth()">Test Backend /auth/me</button>
    <button onclick="clearAuth()">Clear Auth Data</button>
    
    <div id="status"></div>
    
    <h3>Links:</h3>
    <ul>
        <li><a href="http://localhost:3000/auth/login" target="_blank">Frontend Login Page</a></li>
        <li><a href="http://localhost:3000/dashboard" target="_blank">Frontend Dashboard</a></li>
        <li><a href="http://localhost:5000/auth/me" target="_blank">Backend /auth/me (bypassed)</a></li>
    </ul>

    <script>
        const SUPER_ADMIN_USER = {
            id: '675b1a8b-9a47-4f1b-83c7-30b624a3b726',
            email: 'admin@creatives-saas.com',
            name: 'Super Admin',
            firstName: 'Super',
            lastName: 'Admin',
            role: 'SUPER_ADMIN',
            tenantId: null,
            tenant: null
        };
        
        const FITLIFE_OWNER = {
            id: 'ee32d918-fd4a-44ca-bd20-5bc28b7080b4',
            email: 'owner@fitlife-gym.com',
            name: 'Maria Santos',
            firstName: 'Maria',
            lastName: 'Santos',
            role: 'OWNER',
            tenantId: 'f7266a30-3df4-4ac6-b122-ecd5adbfdd42',
            tenant: {
                id: 'f7266a30-3df4-4ac6-b122-ecd5adbfdd42',
                name: 'FitLife Gym',
                slug: 'fitlife-gym'
            }
        };
        
        const POWERFLEX_OWNER = {
            id: 'ebb19d16-281a-43a2-98f9-91e2f93dfa04',
            email: 'owner@powerflex-fitness.com',
            name: 'Juan Cruz',
            firstName: 'Juan',
            lastName: 'Cruz',
            role: 'OWNER',
            tenantId: 'bf80c94d-9399-4d50-b13c-aecdd3c9ca8e',
            tenant: {
                id: 'bf80c94d-9399-4d50-b13c-aecdd3c9ca8e',
                name: 'PowerFlex Fitness',
                slug: 'powerflex-fitness'
            }
        };

        function showStatus(message, type = 'info') {
            const status = document.getElementById('status');
            status.innerHTML = message;
            status.className = `status ${type}`;
        }

        function loginAndRedirect() {
            // Simulate frontend auth
            localStorage.setItem('user_data', JSON.stringify(SUPER_ADMIN_USER));
            localStorage.setItem('auth_token', 'dev-super-admin-token');
            
            showStatus('‚úÖ Logged in as Super Admin! Redirecting to dashboard...', 'success');
            
            // Redirect after a short delay
            setTimeout(() => {
                window.open('http://localhost:3000/dashboard', '_blank');
            }, 1000);
        }
        
        function loginAsTenant(tenant) {
            let user, pagePath;
            if (tenant === 'fitlife') {
                user = FITLIFE_OWNER;
                pagePath = 'members';
            } else if (tenant === 'powerflex') {
                user = POWERFLEX_OWNER;
                pagePath = 'members';
            } else {
                showStatus('‚ùå Unknown tenant', 'error');
                return;
            }
            
            // Simulate frontend auth
            localStorage.setItem('user_data', JSON.stringify(user));
            localStorage.setItem('auth_token', `dev-${tenant}-owner-token`);
            
            showStatus(`‚úÖ Logged in as ${user.tenant.name} Owner! Redirecting to ${pagePath}...`, 'success');
            
            // Redirect after a short delay
            setTimeout(() => {
                window.open(`http://localhost:3000/${pagePath}`, '_blank');
            }, 1000);
        }

        async function testBackendAuth() {
            showStatus('Testing backend /auth/me endpoint...');
            
            try {
                const response = await fetch('http://localhost:5000/auth/me', {
                    headers: {
                        'x-bypass-auth': 'true',
                        'Content-Type': 'application/json'
                    }
                });
                
                const data = await response.json();
                
                if (response.ok) {
                    showStatus(`‚úÖ Backend auth working!\n<pre>${JSON.stringify(data, null, 2)}</pre>`, 'success');
                } else {
                    showStatus(`‚ùå Backend error: ${data.message}`, 'error');
                }
            } catch (error) {
                showStatus(`‚ùå Network error: ${error.message}`, 'error');
            }
        }

        function clearAuth() {
            localStorage.removeItem('user_data');
            localStorage.removeItem('auth_token');
            showStatus('üóëÔ∏è Auth data cleared');
        }
        
        async function quickLogin(email, password) {
            showStatus(`üîê Logging in as ${email}...`);
            
            try {
                const response = await fetch('http://localhost:5000/api/v1/auth/login', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify({ email, password })
                });
                
                const data = await response.json();
                
                if (!response.ok) {
                    throw new Error(data.message || 'Login failed');
                }
                
                if (data.success && data.data.user && data.data.token) {
                    // Store user data and token
                    localStorage.setItem('auth_token', data.data.token);
                    localStorage.setItem('user_data', JSON.stringify(data.data.user));
                    
                    const user = data.data.user;
                    const roleName = user.role.replace('_', ' ');
                    const tenantInfo = user.tenant ? ` (${user.tenant.name})` : '';
                    
                    showStatus(`‚úÖ Logged in as ${user.firstName} ${user.lastName} - ${roleName}${tenantInfo}! Redirecting...`, 'success');
                    
                    // Redirect after a short delay
                    setTimeout(() => {
                        window.open('http://localhost:3000/dashboard', '_blank');
                    }, 1500);
                } else {
                    throw new Error('Invalid response from server');
                }
            } catch (error) {
                showStatus(`‚ùå Login failed: ${error.message}`, 'error');
            }
        }

        // Show current auth status on page load
        window.onload = function() {
            const userData = localStorage.getItem('user_data');
            if (userData) {
                const user = JSON.parse(userData);
                showStatus(`Current user: ${user.email} (${user.role})`, 'success');
            } else {
                showStatus('No auth data found');
            }
        };
    </script>
</body>
</html>
